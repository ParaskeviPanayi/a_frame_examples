<!DOCTYPE html>
<html>

<head>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <style>
    #magnifying-glass {
      cursor: none;
    }
  </style>
</head>

<body>
  <a-scene>
    <!-- 360-degree image background -->
    <a-sky id="background2-image" src="materials/0.jpg" rotation="0 0 0" ></a-sky>

    <a-sky id="background-image" src="materials/0.jpg" rotation="0 0 0"></a-sky>


    <!-- Camera for the magnifying glass -->
    <a-camera id="magnifying-camera">
      <!-- Magnifying glass -->
      <a-circle id="magnifying-glass" position="0 0 -5" radius="0.5"
        material="shader: flat; transparent: true; "></a-circle>

      <a-entity id="menu" position="0 0 -1">

        <!-- Start of Magnifying Glass Elements -->
        <!-- Show -->
        <a-plane id="Mag_glass_button" color="white" width="0.4" height="0.1" depth="0.1" position="-1 0.7 0" clickable>
          <a-text value="Magnifying Glass" color="black" width="1"></a-text>
        </a-plane>

        <a-entity id="zoom_controls" visible="false">
          <a-plane id="zoomin_button" color="white" width="0.4" height="0.1" depth="0.1" position="-1 0.59 0" clickable>
            <a-text value="Zoom In (+)" color="black" width="1"></a-text>
          </a-plane>


          <a-plane id="zoomout_button" color="white" width="0.4" height="0.1" depth="0.1" position="-1 0.48 0"
            clickable>
            <a-text value="Zoom Out (-)" color="black" width="1"></a-text>
          </a-plane>


          <a-plane id="reset_button" color="white" width="0.4" height="0.1" depth="0.1" position="-1 0.37 0" clickable>
            <a-text value="Reset Zoom (0)" color="black" width="1"></a-text>
          </a-plane>


          <a-plane id="hide_button" color="white" width="0.4" height="0.1" depth="0.1" position="-1 0.26 0" clickable>
            <a-text value="hide" color="black" width="1"></a-text>
          </a-plane>
        </a-entity>

        <!-- End of Magnifying Glass Elements -->

        <!-- hammer -->
        <a-plane id="hammer" color="white" width="0.5" height="0.1" depth="0.1" position="-0.5 0.7 0" clickable>
          <a-text value="Hammer" color="black" width="1"></a-text>
        </a-plane>

        <a-plane id="hide_hammer" color="white" width="0.5" height="0.1" depth="0.1" position="-0.5 0.59 0" clickable
          visible="false">
          <a-text value="hide" color="black" width="1"></a-text>
        </a-plane>

        <!-- <a-box color="green" width="2" height="0.2" depth="0.1" position="0 -1 0" clickable></a-box> -->

        <!-- Compass -->
        <a-plane id="compass" color="white" width="0.5" height="0.1" depth="0.1" position="0.05 0.7 0" clickable>
          <a-text value="Compass" color="black" width="1"></a-text>
        </a-plane>

        <!-- Measuring tapes -->
        <a-plane id="compass" color="white" width="0.5" height="0.1" depth="0.1" position="0.6 0.7 0" clickable>
          <a-text value="Measuring tapes" color="black" width="1"></a-text>
        </a-plane>

        <!-- Lightbulb -->
        <a-entity id="lightbulb" width="0.1" height="0.1" depth="0.1" position="1.2 -0.5 0" clikable>
          <a-image src="#lightbulb_pic" width="0.3" height="0.3" geometry="primitive: plane"
            material="side: double;"></a-image>
        </a-entity>

        <a-plane width="0.5" height="0.5" visible="false" id="info_hammer" position="0 -0.5 0"> <a-text value="Stone"
            color="black" width="1" background=""></a-text></a-plane>
      </a-entity>
    </a-camera>


  </a-scene>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var background = document.querySelector('#background2-image');
      var magnifyingGlass = document.querySelector('#magnifying-glass');
      var magnifyingCamera = document.querySelector('#magnifying-camera');
      var renderer = document.querySelector('a-scene').renderer;

      function updateMagnifyingGlass(event) {
        var mouseX = event.clientX;
        var mouseY = event.clientY;

        var windowWidth = window.innerWidth;
        var windowHeight = window.innerHeight;

        var mouseXScene = (mouseX / windowWidth) * 2 - 1;
        var mouseYScene = -(mouseY / windowHeight) * 2 + 1;


        // Adjust the position of the magnifying glass to follow the mouse cursor
        magnifyingGlass.object3D.position.set(mouseXScene, mouseYScene, -1);

        // Adjust the position of the camera to zoom in more
        magnifyingCamera.object3D.position.set(mouseXScene * 2, mouseYScene * 2, -1);

        // Render the background image from the perspective of the magnifying camera
        renderer.render(background.object3D, magnifyingCamera.object3DMap.camera);

        // Update the magnifying glass texture
        magnifyingGlass.setAttribute('material', 'src', renderer.domElement.toDataURL());
      }

      document.addEventListener('mousemove', updateMagnifyingGlass);
    });


    AFRAME.registerComponent('clickable', {
      init: function () {

        var button = this.el; // Reference to the box element
        button.addEventListener('click', function () {
          // console.log('Button Clicked!');

          if (button.id === "Mag_glass_button") {
            show_magnifying_glass();
          }
          else if (button.id === "zoomin_button") {
            zoomIn();
          } else if (button.id === "zoomout_button") {
            zoomOut();
          } else if (button.id === "reset_button") {
            resetZoom();
          } else if (button.id === "hide_button") {
            hide_magnifying_glass();
          } else if (button.id === "hammer") {
            show_hammer();
            console.log('Hammer!');
          } else if (button.id === "hide_hammer") {
            hide_hammer();

          }
        });
      }
    });



  </script>
</body>

</html>